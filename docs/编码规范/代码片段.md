## 实例运行
```vue
<template>
  <CountComponent :initialCount="2" :step="2" @reachTen="(count) => { console.log('到达: ',count) }">
    <template #title="{ subject }">
      <h2>计数器-{{ subject }}类型</h2>
    </template>
  </CountComponent>
</template>
```

## 在 tsx 中使用 defineComponent
+ **基础使用**

```tsx
// xx.tsx
import { defineComponent, ref, onMounted, useSlots } from 'vue'

const Default = defineComponent((props, { emit }) => {
  const count = ref(props.initialCount || 0);

  const slots = useSlots();

  const increment = () => {
    count.value += props.step || 1;

    if (count.value >= 10) {
      emit('reachTen', count.value);
    }
  };

  onMounted(() => {
    console.log('计数器组件已挂载');
  });

  return () => (
    <div class="count-container">
      {slots.title && slots.title({ subject: 'defineComponent-jsx' })}
      <div class="count-display">当前计数: {count.value}</div>
      <div class="count-buttons">
        <button class="btn" onClick={increment}>+</button>
      </div>
    </div>
  )
}, {
  name: '',
  props: {
    initialCount: {
      type: Number,
      default: 0
    },
    step: {
      type: Number,
      default: 1
    }
  },
  emits: {
    reachTen: (count: number): boolean => {
      if (typeof count === 'number' && !isNaN(count)) {
        return true;
      }
      console.warn('reachTen 事件的参数必须是有效的数字类型');
      return false;
    }
  }
})

export default Default
```

+ **v-model 使用**

```tsx
import { defineComponent, ref, onMounted } from 'vue'

const Default = defineComponent((props, { emit }) => {
  const count = ref(props.modelValue || 0);

  const increment = () => {
    count.value += 1;
    emit('update:modelValue', count.value);
  };

  return () => (
    <div class="count-container">
      <div class="count-display">当前计数: {count.value}</div>
      <div class="count-buttons">
        <button class="btn" onClick={increment}>+</button>
      </div>
    </div>
  )
}, {
  props: {
    modelValue: {
      type: Number,
      default: 0
    }
  },
  emits: {
    'update:modelValue': (value: number) => {
      if (typeof value === 'number' && !isNaN(value)) {
        return true;
      }
      console.warn('update:modelValue 事件的参数必须是有效的数字类型');
      return false;
    }
  }
})

export default Default
```

## 直接使用 scriptSetup
+ **基础使用**

```vue
<script setup lang="ts" name="CountComponent">
  import { ref, onMounted, defineEmits, defineProps, withDefaults } from 'vue'

  interface Props {
    initialCount: number
    step: number
  }
  const props = withDefaults(defineProps<Props>(), {
    initialCount: 0,
    step: 1
  });

  interface Emit {
    (event: 'reachTen', value: number): void;
  }
  const emit = defineEmits<Emit>();

  const count = ref(props.initialCount || 0);

  const increment = () => {
    count.value += props.step || 1;
    if (count.value >= 10) {
      emit('reachTen', count.value);
    }
  };

  onMounted(() => {
    console.log('计数器组件已挂载');
  });
</script>

<template>
  <div class="count-container">
    <slot name="title" subject="sfc-setup"></slot>
    <div class="count-display">当前计数: {{ count }}</div>
    <div class="count-buttons">
      <button class="btn" @click="increment">+</button>
    </div>
  </div>
</template>
```

+ **v-model 使用**

```vue
<script setup lang="ts" name="CountComponent">
  import { ref, defineEmits, defineProps, withDefaults } from 'vue'

  interface Props {
    modelValue: number
  }
  const props = withDefaults(defineProps<Props>(), {
    modelValue: 0,
  });

  interface Emit {
    (event: 'update:modelValue', value: number): void;
  }
  const emit = defineEmits<Emit>();

  const count = ref(props.modelValue);

  const increment = () => {
    count.value += 1;
    emit('update:modelValue', count.value);
  };
</script>

<template>
  <div class="count-container">
    <div class="count-display">当前计数: {{ count }}</div>
    <div class="count-buttons">
      <button class="btn" @click="increment">+</button>
    </div>
  </div>
</template>
```

+ Render 模板

```vue

```

## 函数式组件-FunctionalComponent
+ **基本使用**

```vue
import type { FunctionalComponent } from 'vue'
import { ref } from 'vue'

// 定义 Props 类型
interface FComponentProps {
  count: number;
}

// 定义 Emit 类型 单独定义
// type Emit = (event: 'update:count', value: number) => void;

type FComponentEvents = {
  reachTen(value: number): void
  'update:count'(value: number): void
}

export default (props,
  { emit, slots }): FunctionalComponent<FComponentProps, FComponentEvents> => {
  const count = ref(props.count);

  const increment = () => {
    count.value += 1;
    emit('update:count', count.value);

    if (count.value >= 10) {
      emit('reachTen', count.value);
    }
  };

  return (
    <div class="count-container">
      {slots.title && slots.title({ subject: 'functional-jsx' })}
      <div class="count-display">当前计数: {count.value}</div>
      <div class="count-buttons">
        <button class="btn" onClick={increment}>+</button>
      </div>
    </div>
  )
}
```



```vue
<script lang="tsx" name="BoxContent">
import type { DialogProps, PopoverProps } from 'element-plus';
import { defineComponent, ref, onMounted, useSlots, unref, defineExpose, type Slots, computed } from 'vue';

type Recordable<T = any, K extends string | number | symbol = string> = Record<K, T>

export default defineComponent((props, { attrs, emit, expose }) => {
  const visible = ref(false);

  function open() {
    visible.value = true;
  }

  function close() {
    visible.value = false;
  }

  const mergeProps = ref<DialogProps | PopoverProps>({})


  const getProps = computed(() => {
    const propsObj = { ...props }
    Object.assign(propsObj, unref(mergeProps))
    return propsObj
  })

  const slots = useSlots();

  expose({
    open,
    close
  });

  function renderPop() {
    console.log(getSlot(slots, 'footer'))
    return (
      <el-popover
        {...unref(getBindValue)}
      >
        {{
          default: () => (
            <div>
              {getSlot(slots, 'default')}
              {getSlot(slots, 'footer')}
            </div>
          ),
          reference: () => getSlot(slots, 'reference'),
        }}
      </el-popover>
    )
  }

  const getSlot = (slots: Slots, slot = 'default') => {
    // Reflect.has 判断一个对象是否存在某个属性
    if (!slots || !Reflect.has(slots, slot)) {
      return null
    }
    const slotFn = slots[slot]
    if (!slotFn) return null
    return slotFn()
  }

  const getBindValue = computed(() => {
    const bindValue: Recordable = { ...attrs, ...props }
    delete bindValue.columns
    delete bindValue.data
    return bindValue
  })

  function renderDialog() {
    return (
      <>
        {
          slots.reference ? slots.reference() : undefined
        }
        <el-dialog
          v-model={visible.value}
          {...unref(getBindValue)}
        >
          {{
            default: () => getSlot(slots, 'default'),
            // @ts-ignore
            footer: () => getSlot(slots, 'footer')
          }}
        </el-dialog>
      </>
    )
  }

  return () => (
    <>
      {
        !getProps.value.isMobile ? renderPop() : renderDialog()
      }
    </>
  )
}, {
  name: '',
  props: {
    isMobile: {
      type: Boolean,
      default: false
    }
  },
  emits: {
    reachTen: (count: number): boolean => {
      if (typeof count === 'number' && !isNaN(count)) {
        return true;
      }
      console.warn('reachTen 事件的参数必须是有效的数字类型');
      return false;
    }
  }
})

</script>
```

```vue
<script setup lang="ts">
import { onMounted, ref } from 'vue';
import BoxContent from './components/BoxContent.vue';

const BoxContentRef = ref<InstanceType<typeof BoxContent> | null>(null);

// 在组件挂载后打印 BoxContentRef 的值
onMounted(() => {
  console.log('BoxContentRef:', BoxContentRef.value);
});

const isMobile = ref(false); // 是否为移动端模式

function openBox(bool: boolean) {
  console.log('打开抄送弹窗', bool);
  isMobile.value = bool; // 设置为非移动端模式
  BoxContentRef.value?.open();
}

function closeBox() {
  BoxContentRef.value?.close();
}

const copyForm = ref({
  copyUserIds: [],
  copyReason: ''
});

function handleCopy() {
  console.log('抄送人:', copyForm.value.copyUserIds);
  console.log('抄送意见:', copyForm.value.copyReason);
  closeBox();
}

const userOptions = ref([
  { id: 1, nickname: '张三' },
  { id: 2, nickname: '李四' },
  { id: 3, nickname: '王五' },
]);

</script>

<template>
  <BoxContent ref="BoxContentRef" :isMobile="false" placement="top-start" :width="420" trigger="click" title="抄送信息"
    :fullscreen="false" top="20vh">
    <template #reference>
      <el-button plain type="warning" @click="openBox(true)">
        抄送-dialog
      </el-button>
      <el-button plain type="warning" @click="openBox(false)">
        抄送-popover
      </el-button>
    </template>
    <el-form label-position="top" class="mb-auto" ref="copyPopFormRef" :model="copyForm" label-width="100px">
      <el-form-item label="抄送人" prop="copyUserIds">
        <el-select v-model="copyForm.copyUserIds" clearable style="width: 100%" multiple placeholder="请选择抄送人">
          <el-option v-for="item in userOptions" :key="item.id" :label="item.nickname" :value="item.id" />
        </el-select>
      </el-form-item>
      <el-form-item label="抄送意见" prop="copyReason">
        <el-input v-model="copyForm.copyReason" clearable placeholder="请输入抄送意见" type="textarea" :rows="3" />
      </el-form-item>
    </el-form>
    <template #footer>
      <el-button type="primary" @click="handleCopy"> 确定</el-button>
      <el-button @click="closeBox()"> 取消</el-button>
    </template>
  </BoxContent>
</template>
```

## 相关链接
[snippet generator](https://snippet-generator.app/?description=&tabtrigger=&snippet=&mode=vscode)

[defineComponent()](https://cn.vuejs.org/api/general.html#definecomponent)

[Vue.js](https://cn.vuejs.org/guide/extras/render-function.html#typing-functional-components)

[Vue JSX Explorer](https://vue-jsx-explorer.netlify.app/#import%20%7B%20defineComponent%20%7D%20from%20'vue'%0A%0Aconst%20App%20%3D%20defineComponent((props)%20%3D%3E%20%3Cdiv%3EHello%20World%3C%2Fdiv%3E))

[GitHub - vitejs/vite-plugin-vue: Vite Vue Plugins](https://github.com/vitejs/vite-plugin-vue/tree/main)

